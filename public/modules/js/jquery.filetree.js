!function(e){var t={root:"/",script:"",showroot:"/data/home",onclick:function(e,t,i,a){},oncheck:function(e,t,i,a){},usecheckboxes:!1,expandSpeed:500,collapseSpeed:500,expandEasing:null,collapseEasing:null,canselect:!0},i={init:function(i){0!=e(this).length&&($this=e(this),e.extend(t,i),""!=t.showroot&&(checkboxes="",!0!==t.usecheckboxes&&"dirs"!==t.usecheckboxes||(checkboxes='<input type="checkbox" />'),$this.html('<ul class="jaofiletree"><li class="drive directory collapsed selected">'+checkboxes+'<a href="#" data-file="'+t.root+'" data-type="dir">'+t.showroot+"</a></li></ul>")),openfolder(t.root))},open:function(e){openfolder(e)},close:function(e){closedir(e)},getchecked:function(){var t=new Array,i=0;return $this.find("input:checked + a").each((function(){t[i]={type:e(this).attr("data-type"),file:e(this).attr("data-file")},i++})),t},getselected:function(){var t=new Array,i=0;return $this.find("li.selected > a").each((function(){t[i]={type:e(this).attr("data-type"),file:e(this).attr("data-file")},i++})),t}};openfolder=function(i){var a;$this.find('a[data-file="'+i+'"]').parent().hasClass("expanded")||(a=e.ajax({type:"POST",url:t.script,data:{dir:i,_token:window.Laravel.csrfToken},context:$this,dataType:"json",beforeSend:function(){this.find('a[data-file="'+i+'"]').parent().addClass("wait")}}).done((function(e){for(a='<ul class="jaofiletree" style="display: none">',ij=0;ij<e.length;ij++)"dir"==e[ij].type?classe="directory collapsed":classe="file ext_"+e[ij].ext,a+='<li class="'+classe+'">',!0===t.usecheckboxes||"dirs"===t.usecheckboxes&&"dir"==e[ij].type||"files"===t.usecheckboxes&&e[ij].type,a+='<a href="#" rel="'+e[ij].fileid+'" data-file="'+i+e[ij].file+'/" data-type="'+e[ij].type+'">'+e[ij].file+"</a>",a+="</li>";a+="</ul>",this.find('a[data-file="'+i+'"]').parent().removeClass("wait").removeClass("collapsed").addClass("expanded"),this.find('a[data-file="'+i+'"]').after(a),this.find('a[data-file="'+i+'"]').next().slideDown(t.expandSpeed,t.expandEasing),t.usecheckboxes&&(this.find('li input[type="checkbox"]').attr("checked",null),this.find('a[data-file="'+i+'"]').prev(":not(:disabled)").attr("checked","checked"),this.find('a[data-file="'+i+'"] + ul li input[type="checkbox"]:not(:disabled)').attr("checked","checked")),setevents()})).done((function(){$this.trigger("afteropen"),$this.trigger("afterupdate")})))},closedir=function(i){$this.find('a[data-file="'+i+'"]').next().slideUp(t.collapseSpeed,t.collapseEasing,(function(){e(this).remove()})),$this.find('a[data-file="'+i+'"]').parent().removeClass("expanded").addClass("collapsed"),setevents(),$this.trigger("afterclose"),$this.trigger("afterupdate")},setevents=function(){$this.find("li a").unbind("click"),$this.find("li a").bind("click",(function(){return t.onclick(this,e(this).attr("data-type"),e(this).attr("data-file"),e(this).attr("rel")),t.usecheckboxes&&"file"==e(this).attr("data-type")&&($this.find('li input[type="checkbox"]').attr("checked",null),e(this).prev(":not(:disabled)").attr("checked","checked"),e(this).prev(":not(:disabled)").trigger("check")),t.canselect&&($this.find("li").removeClass("selected"),e(this).parent().addClass("selected")),!1})),$this.find('li input[type="checkbox"]').bind("change",(function(){t.oncheck(this,e(this).is(":checked"),e(this).next().attr("data-type"),e(this).next().attr("data-file")),e(this).is(":checked")?$this.trigger("check"):$this.trigger("uncheck")})),$this.find("li.directory.collapsed a").bind("click",(function(){return i.open(e(this).attr("data-file")),!1})),$this.find("li.directory.expanded a").bind("click",(function(){return i.close(e(this).attr("data-file")),!1}))},e.fn.jaofiletree=function(e){return i[e]?i[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?void 0:i.init.apply(this,arguments)}}(jQuery);
