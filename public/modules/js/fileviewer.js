function initFileTree(){$(".fileinspector_filetree").on("changed.jstree",function(e,t){if(t.selected.length&&t.instance.get_node(t.selected[0]).original.fid){var i=t.instance.get_node(t.selected[0]).original.fid;$.ajax({type:"POST",dataType:"json",cache:!1,url:"/game/module/FileViewer/ajax/open",data:{_token:window.Laravel.csrfToken,fid:i},success:function(e){!0===e.result?!1===e.encrypted?"image"===e.filetype?($(".fileinspector_div").css("background-image","url('"+wwwRoot+e.content+"')"),$(".fileinspector_div").show(),$(".fileinspector_filecontent").hide()):($(".fileinspector_filecontent").text(e.content),$(".fileinspector_div").hide(),$(".fileinspector_filecontent").show()):($(".fileinspector_filecontent").text(""),$.notification({title:"File Inspector",icon:"b",color:"#fff",content:"The selected file is encrypted!",timeout:4e3})):$(".fileinspector_filecontent").text("")}})}}).jstree({core:{themes:{name:"default-dark",icons:!0,url:"css/jstree/style.min.css"},data:{url:"/game/module/FileViewer/get/list",data:{_token:window.Laravel.csrfToken,hostID:fileViewerHost,hostPassword:fileViewerHostPassword},dataType:"json"}},plugins:["contextmenu","wholerow"],contextmenu:{items:function(){return!(atob(fileViewerModuleVersion)<=1)&&(0!=fileViewerHost&&{download:{separator_before:!1,separator_after:!1,label:"Download",action:function(e){var t=$.jstree.reference(e.reference).get_node(e.reference);$.ajax({type:"POST",dataType:"json",cache:!1,url:"/game/module/FileViewer/ajax/downloadFile",data:{_token:window.Laravel.csrfToken,fid:t.original.fid,server_password:fileViewerHostPassword},success:function(e){!0===e.result?$.notification({title:"Download complete!",icon:"b",timeout:4e3,color:"#fff",content:"The file: "+t.text+" has been downloaded!"}):alert("DOWNLOAD FAILED")}})}}})}}})}jQuery(document).ready(function(e){e("#fileViewer-browse-local").click(function(){e("#hostAddress").val(""),fileViewerHost=0,e(".fileinspector_filetree").remove(),e("#fileinspector_left").append('<div class="fileinspector_filetree"></div>'),initFileTree()}),e("#fileViewer-connect").click(function(){e.ajax({type:"POST",dataType:"json",cache:!1,url:"/game/module/FileViewer/ajax/connectToRemoteServer",data:{_token:window.Laravel.csrfToken,host:e("#hostAddress").val()},success:function(t){!0===t.result?(fileViewerHost=t.host,e(".fileinspector_filetree").remove(),e("#fileinspector_left").append('<div class="fileinspector_filetree"></div>'),initFileTree()):t.password_protected?(fileViewerHost=t.host,e("#server_prompt_password_window").dialog({width:320,height:150,hide:{effect:window.closeEffect,duration:window.closeDuration},close:function(e,t){},focus:function(t,i){e(this).dialog("moveToTop")}})):alert(t.message)}})}),initFileTree()});
